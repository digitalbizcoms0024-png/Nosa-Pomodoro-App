# Milestone v1.0: Background Audio

**Status:** SHIPPED 2026-02-07
**Phases:** 1-2
**Total Plans:** 3

## Overview

This roadmap delivered background audio capabilities to the existing pomodoro timer PWA. In 2 phases, we integrated free streaming audio with curated categories, built controls that fit the minimal UI aesthetic, and polished the integration with volume ducking for alerts.

## Phases

### Phase 1: Streaming Audio & Categories
**Goal**: Users can play free streaming audio during focus sessions with category selection and full playback controls
**Depends on**: Nothing (first phase)
**Requirements**: AUDIO-01, AUDIO-02, AUDIO-03, AUDIO-04, CAT-01, CAT-02, CAT-03, UI-01, UI-02
**Success Criteria** (what must be TRUE):
  1. User can play and pause background audio via HTML5 `<audio>` element
  2. User can choose from audio categories
  3. Each category contains curated streaming tracks (SomaFM)
  4. User can adjust volume and mute/unmute audio
  5. Audio controls appear as minimal indicator that expands to full controls
  6. Tracks auto-advance when one ends
  7. No visible video player — audio only
**Plans**: 2 plans

Plans:
- [x] 01-01-PLAN.md — Audio engine, station data, and service worker update
- [x] 01-02-PLAN.md — Audio controls UI and app integration

### Phase 2: Polish & Integration
**Goal**: Audio integrates seamlessly with timer lifecycle and app theme
**Depends on**: Phase 1
**Requirements**: AUDIO-05
**Success Criteria** (what must be TRUE):
  1. Music volume automatically ducks during timer chime alerts
**Plans**: 1 plan

Plans:
- [x] 02-01-PLAN.md — Volume ducking with smooth RAF fades during timer chimes

## Progress

| Phase | Plans Complete | Status | Completed |
|-------|----------------|--------|-----------|
| 1. Streaming Audio & Categories | 2/2 | Complete | 2026-02-06 |
| 2. Polish & Integration | 1/1 | Complete | 2026-02-06 |

---

## Milestone Summary

**Key Decisions:**
- Free streaming URLs (SomaFM) over YouTube embeds — no visible player needed
- Hidden `<audio>` element with custom JS controls — no native player chrome
- Minimal indicator + expandable panel UI pattern — keeps timer screen clean
- SomaFM URLs only for launch — verified HTTPS + CORS
- Reduced to 2 categories (Ambient, Focus Beats) — SomaFM lacks dedicated lofi/nature content
- Duck to 20% of current volume with exponential easing for natural perception
- Manual volume changes during ducking cancel the duck to respect user intent

**Issues Resolved:**
- YouTube IFrame API rejected (visible 200x200px player requirement too intrusive)
- Pivoted from 4 categories to 2 after discovering SomaFM content limitations
- iOS Safari audio compatibility handled via .catch() on all play() calls

**Issues Deferred:**
- SomaFM TOS — technically prohibits embedding without written permission
- Only 2 categories available — could add more sources in future

**Technical Debt Incurred:**
- SomaFM TOS compliance needs resolution
- Limited audio category variety (2 vs originally planned 4)

---
_For current project status, see .planning/ROADMAP.md_
